"""
Model for vulnerability representation
"""
# pylint: disable=R0902,R0903


class VulnerabilityModel:
    """
    Data model representing a single vulnerability.

    This class holds all information about a vulnerability,
    from the initial report to the final remediation,
    including file paths and code snippets.
    """

    def __init__(self, finding_data: dict):
        self.id: str = finding_data.get('id', 'N/A')
        self.type: str = finding_data.get('tipo_vulnerabilidad', 'Unknown')
        self.endpoint: str = finding_data.get('endpoint', 'Unknown')
        self.severity: str = finding_data.get('severidad', 'N/A')
        self.status: str = "Pending"
        self.target_file: str | None = None
        self.original_code: str | None = None
        self.corrected_code: str | None = None
        self.agent_log: list[str] = []

    def to_json(self) -> dict:
        """Serializes the model's data into a dictionary."""
        return {
            "id": self.id,
            "type": self.type,
            "endpoint": self.endpoint,
            "status": self.status,
            "target_file": self.target_file,
            "agent_log": self.agent_log,
            "corrected_code": self.corrected_code
        }
